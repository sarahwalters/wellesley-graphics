
<html>
  <head>
    <title>Draw Points</title>
    <style>
      /* feel free to style the canvas any way you want. If you want it to
      use the entire window, set width: 100% and height: 100%. */

      body { margin: 0px; padding: 0px }

      canvas {
          display: block;
          width: 100%;
          height: 100%;
      }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
    <script src="https://cs.wellesley.edu/~cs307/threejs/libs/three-r67.min.js"></script>
    <script src="https://cs.wellesley.edu/~cs307/threejs/libs/tw.js"></script>
    <script src="https://cs.wellesley.edu/~cs307/threejs/libs/OrbitControls.js"></script>
  </head>
<body>

<script>

var scene = new THREE.Scene();
var renderer = new THREE.WebGLRenderer();

TW.mainInit(renderer,scene);

function Shapes() {
    // "normalized" balloon bezier with a height of 1
    var _balloonBezier = new THREE.CubicBezierCurve3(
        new THREE.Vector3(-0.05, 0, -0.05),
        new THREE.Vector3(0.35, 0, 0.1),
        new THREE.Vector3(0.8, 0, 0.95),
        new THREE.Vector3(0, 0, 1)
    );
    var _normalizedBalloonPoints = _balloonBezier.getPoints(20);

    // origin is center of base of cone representing tie-off at bottom of balloon
    // rotationally symmetrical about y axis, which points up through center of balloon
    this.balloon = function(height, color) {
        var controlPoints = _normalizedBalloonPoints.map(function(cp) {
            return _.clone(cp).multiplyScalar(height);
        });
        var balloonGeometry = new THREE.LatheGeometry(controlPoints, 20);
        var balloonMaterial = new THREE.MeshBasicMaterial({
            color: color,
            specular: 0xffffff,
            shininess: 30,
            transparent: true,
            opacity: 0.5
        });
        var balloonMesh = new THREE.Mesh(balloonGeometry, balloonMaterial);
        balloonMesh.name = "balloon";
        UTILS.setRotation(balloonMesh, {a: -Math.PI/2, b: 0, c: 0});
        return balloonMesh;
    }
}

function Params() {
    this.balloonHeight = 10;
    this.meshRadius = 3;
}

var UTILS = {
    setPosition: function(obj, position) {
        obj.position.set(position.x, position.y, position.z);
    },

    setRotation: function(obj, rotation) {
        obj.rotation.set(rotation.a, rotation.b, rotation.c);
    },

    generateBalloonPositions: function(params) {
        var mesh = [];
        for (var i = -params.meshRadius; i < params.meshRadius; i++) {
            for (var j = -params.meshRadius; j < params.meshRadius; j++) {
                var distanceFromOrigin = Math.sqrt(Math.pow(i, 2) + Math.pow(j, 2));
                if (distanceFromOrigin <= params.meshRadius) {
                    mesh.push([i, j]);
                }
            }
        }
        return mesh;
    }
};

function draw(shapes, params) {
    var positions = UTILS.generateBalloonPositions(params);
    console.log(positions);

    var balloon1 = shapes.balloon(params.balloonHeight, 0xff0000);
    UTILS.setPosition(balloon1, {x: 0, y: 0, z: 0});
    scene.add(balloon1);

    var balloon2 = shapes.balloon(params.balloonHeight, 0x0000ff);
    UTILS.setPosition(balloon2, {x: 0, y: 0, z: 10});
    scene.add(balloon2);
}
var shapes = new Shapes();
var params = new Params();
draw(shapes, params);


var splineObj;

function remakeSplineObj() {
    scene.remove(splineObj);
    var mat = new THREE.MeshBasicMaterial({color: 0x00FF00, opacity: 1});
    curve = new THREE.SplineCurve3 ( examplePts );
    var geom = new THREE.Geometry();
    geom.vertices = curve.getPoints(50);
    splineObj = new THREE.Line( geom, new THREE.LineBasicMaterial( { linewidth: 3, color: 0x00ff00 }) );
    splineObj.name = "spline";
    scene.add(splineObj);
}
//remakeSplineObj();

function addSphereAt(pt) {
    var sph = new THREE.Mesh( new THREE.SphereGeometry(0.5),
                              new THREE.MeshNormalMaterial());
    sph.position.copy(pt);
    scene.add(sph);
    return sph;
}

function addAllCP() {
    var pts = examplePts;
    for( var i=0; i<pts.length; i++ ) {
        addSphereAt(pts[i]);
    }
}
//addAllCP();

var cameraFOVY = 75;

var state = TW.cameraSetup(renderer,
                           scene,
                           {minx: -10, maxx: 10,
                            miny: -10, maxy: 10,
                            minz: -10, maxz: 10},
                           cameraFOVY);

TW.render();

</script>


</body>
</html>
